---
title: "Fix Flash of Unstyled Content"
description: "Once in a while users report that the see FOUC on navigation when using Astro's Client Router. Here is how to fix this." 
---

Does this sound familiar to you? 

> Does anyone know what might have broken the view transition stuff? 
> I get massive FOUC on page transitions, it would seem.

> We noticed a flash of unstyled content between page transitions using the <ClientRouter />.

While these questions arose from two completely different projects in a course of 2 month, it was a big surprise to see that both had the same root cause.

## Solution

Check your DOM _inside the browser_ to see what the `<head>` children look like before and after the swap.
Are all the style elements present that you expect?

If your head ends prematurely check, the first elements of the body for culprits that where pushed there from the head and tore other element, especially style elements, with them. 

If you have such relocated elements, explicitly move them to the body to avoid chaos in your styles.

## Details

If you are interested in what caused this error and why moving elements to the body is a solution: here are the detail.


### How the Swap Works

### How the Browser Works


The root cause of the broken styling is the miss-placement of the <SpeedInsights/> component. 
It's placed inside the head, where it inserts a custom-tag. The browser knows, that those do not belong in the head. So it closes the head and starts the body. Everything that follows the custom-tag is now also in the body, including styling that should have been in the head. 
In the HTML, everything looks fine. but if you examine the DOM in Devtools, you will see, that for example your og:* properties end up in the body.  This also happens with your current production site.
Long story short: When the <ClientRouter /> (new name for <ViewTransitions />) swaps the body, styles are cleared and than reloaded which leads to the FOUC.
For my tests, moving <SpeedInsights /> from <Headers> to the <body> (in DocsLayout) did the trick. Let me hear if that's a reproducible solution on your end, too.
